(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{388:function(t,s,a){"use strict";a.r(s);var n=a(8),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),s("p",[t._v("在企业内部系统中，LDAP（Lightweight Directory Access Protocol，轻量级目录访问协议）被广泛用于实现统一身份认证和用户信息管理。通过构建 LDAP 服务，可以统一管理用户账户、部门信息以及访问权限，并提供集中化的用户认证服务。")]),t._v(" "),s("p",[t._v("本文将介绍如何通过 Docker 快速搭建一套可视化、可自助修改密码的 LDAP 环境，适合用于测试、开发或企业内网部署使用。")]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"ldap-基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ldap-基本概念"}},[t._v("#")]),t._v(" LDAP 基本概念")]),t._v(" "),s("p",[t._v("LDAP 是一种用于访问和管理分布式目录信息服务的协议，它以树状结构组织数据，类似于文件系统。")]),t._v(" "),s("h3",{attrs:{id:"常用术语说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用术语说明"}},[t._v("#")]),t._v(" 常用术语说明")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("关键字")]),t._v(" "),s("th",[t._v("全称")]),t._v(" "),s("th",[t._v("含义")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("strong",[t._v("dn")])]),t._v(" "),s("td",[t._v("Distinguished Name")]),t._v(" "),s("td",[t._v("条目的唯一标识，类似主键，例如："),s("code",[t._v("uid=cs01,ou=users,dc=demo,dc=com")])])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("uid")])]),t._v(" "),s("td",[t._v("User ID")]),t._v(" "),s("td",[t._v("用户登录名，例如 "),s("code",[t._v("cs01")])])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("cn")])]),t._v(" "),s("td",[t._v("Common Name")]),t._v(" "),s("td",[t._v("通用名称，用户时可用于显示名，组时为组名")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("sn")])]),t._v(" "),s("td",[t._v("Surname")]),t._v(" "),s("td",[t._v("用户的姓氏，LDAP 必填字段之一")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("ou")])]),t._v(" "),s("td",[t._v("Organizational Unit")]),t._v(" "),s("td",[t._v("组织单位，例如 "),s("code",[t._v("users")]),t._v("、"),s("code",[t._v("departments")])])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("dc")])]),t._v(" "),s("td",[t._v("Domain Component")]),t._v(" "),s("td",[t._v("域组件，如 "),s("code",[t._v("dc=demo,dc=com")]),t._v(" 表示 "),s("code",[t._v("demo.com")])])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("mail")])]),t._v(" "),s("td",[t._v("邮箱地址")]),t._v(" "),s("td",[t._v("用户邮箱地址")])]),t._v(" "),s("tr",[s("td",[s("strong",[t._v("userPassword")])]),t._v(" "),s("td",[t._v("密码")]),t._v(" "),s("td",[t._v("存储用户密码（通常为加密格式）")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"常用对象类型说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用对象类型说明"}},[t._v("#")]),t._v(" 常用对象类型说明")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("描述")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("inetOrgPerson")])]),t._v(" "),s("td",[t._v("最常用的用户对象类型，支持邮件、电话、地址等属性")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("organizationalUnit")])]),t._v(" "),s("td",[t._v("组织单位类型，如部门")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("groupOfNames")])]),t._v(" "),s("td",[t._v("组对象，可包含多个成员 DN")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"使用-docker-搭建-ldap-服务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-docker-搭建-ldap-服务"}},[t._v("#")]),t._v(" 使用 Docker 搭建 LDAP 服务")]),t._v(" "),s("p",[t._v("我们使用三大组件构建完整 LDAP 管理环境：")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("OpenLDAP")]),t._v("：核心 LDAP 服务；")]),t._v(" "),s("li",[s("strong",[t._v("phpLDAPadmin")]),t._v("：LDAP 可视化管理工具；")]),t._v(" "),s("li",[s("strong",[t._v("Self-Service Password")]),t._v("：用户自助密码修改平台。")])]),t._v(" "),s("h3",{attrs:{id:"服务与镜像说明"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务与镜像说明"}},[t._v("#")]),t._v(" 服务与镜像说明")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("镜像名称")]),t._v(" "),s("th",[t._v("用途")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("osixia/openldap:1.5.0")])]),t._v(" "),s("td",[t._v("OpenLDAP 主服务")]),t._v(" "),s("td",[t._v("提供 LDAP 协议服务")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("osixia/phpldapadmin:0.9.0")])]),t._v(" "),s("td",[t._v("可视化管理界面")]),t._v(" "),s("td",[t._v("管理用户/组织等数据")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("tiredofit/self-service-password:5.3.1")])]),t._v(" "),s("td",[t._v("密码修改工具")]),t._v(" "),s("td",[t._v("用户自助修改密码页面")])])])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"docker-compose-配置部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-配置部署"}},[t._v("#")]),t._v(" docker-compose 配置部署")]),t._v(" "),s("p",[t._v("将以下内容保存为 "),s("code",[t._v("docker-compose.yml")]),t._v(" 文件：")]),t._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3.8'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("openldap")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" osixia/openldap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("1.5.0\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" openldap\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" TZ=Asia/Shanghai\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" LDAP_DOMAIN=demo.com\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" LDAP_ADMIN_PASSWORD=123456\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 389"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("389")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 636"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("636")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./data/openldap/slapd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/etc/ldap/slapd.d\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./data/openldap/data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/lib/ldap\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("phpldapadmin")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" osixia/phpldapadmin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("0.9.0\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" phpldapadmin\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privileged")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" PHPLDAPADMIN_LDAP_HOSTS=openldap\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" PHPLDAPADMIN_HTTPS=false\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("depends_on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" openldap\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 8081"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./data/phpldapadmin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/var/www/phpldapadmin\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("self-service-password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tiredofit/self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("5.3.1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ldap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("password\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("depends_on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" openldap\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" 8080"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" LDAP_SERVER=ldap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//openldap\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" LDAP_BINDDN=cn=admin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("dc=demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("dc=com\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" LDAP_BINDPASS=123456\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" LDAP_BASE_SEARCH=dc=demo"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("dc=com\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./data/ldap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("password/ssp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/www/ssp\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./data/ldap"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("password/logs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("/www/logs\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br")])])])}),[],!1,null,null,null);s.default=e.exports}}]);